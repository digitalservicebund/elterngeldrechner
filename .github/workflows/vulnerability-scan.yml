name: Vulnerability Scan

on:
  schedule:
    - cron: 0 0 * * *
  workflow_dispatch: {}

jobs:
  scan-for-vulnerabilities:
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v5

      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@18f2510ee396bbf400402947b394f2dd8c87dbb0 # v0.29.0
        with:
          scan-type: fs
          scan-ref: .
          format: sarif
          severity: "HIGH,CRITICAL"
          limit-severities-for-sarif: true
          exit-code: 1
