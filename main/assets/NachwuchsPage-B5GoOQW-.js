import{e as W,j as e,c as y,n,_ as O,g as K,a as $,p as J,r as S,B as v,D as w,u as P,b as q,P as Y,f as N,s as H,h as Z}from"./index-DPo_heNS.js";import{g as Q,D as B,a as U,I as X,b as ee,c as b,u as se,d as te,F as G,i as re,e as ne,_ as ae}from"./Monatsplaner-BtFO3Gro.js";import{B as ie}from"./ButtonGroup-BnI4oyV-.js";import"./egr-configuration-BkWsa5ZA.js";function le(t){const r=oe(t);W(ce,r)}function oe(t){const r=new Date,s=new Date(new Date().setMonth(r.getMonth()-3)),a=t>r,o=s<=t&&t<=r;return a?"werdende Eltern":o?"junge Eltern":"nachbeantragende Eltern"}const ce="nutzergruppe";function ue({register:t,registerOptions:r,name:s,label:a,errors:o,onIncrease:i,onDecrease:c,required:l}){const u=Q(o,s);return e.jsxs("div",{className:y(n("counter"),u&&n("counter--error")),children:[e.jsx("label",{className:n("counter__label"),htmlFor:s,children:a}),e.jsxs("div",{className:n("counter__controls"),children:[e.jsx("button",{className:n("counter__button"),type:"button",onClick:c,"aria-label":"verringern","aria-controls":s,children:e.jsx(O,{})}),e.jsx("input",{...t(s,r),className:n("counter__input"),type:"number",id:s,"aria-describedby":u?`${s}-error`:void 0,"aria-invalid":!!u,required:l}),e.jsx("button",{className:n("counter__button"),type:"button",onClick:i,"aria-label":"erhöhen","aria-controls":s,children:e.jsx(K,{})})]}),!!u&&e.jsx(B,{id:`${s}-error`,error:!0,children:u.message})]})}function M({control:t,rules:r,name:s,label:a,required:o,info:i}){const{field:{onChange:c,onBlur:l,value:u,ref:g},fieldState:{error:d}}=U({control:t,rules:r,name:s});return e.jsxs("div",{className:n("custom-date"),children:[e.jsxs("div",{className:n("custom-date__label"),children:[e.jsx("label",{htmlFor:s,children:a}),!!i&&e.jsx(X,{info:i})]}),e.jsxs("div",{className:y(n("custom-date__field"),d&&n("custom-date__field--error")),children:[e.jsx("span",{className:n("custom-date__placeholder"),"aria-hidden":!0,children:"TT.MM.JJJJ"}),e.jsx(ee,{className:n("custom-date__input"),name:s,id:s,inputRef:g,mask:Date,lazy:!0,autofix:"pad",value:u,blocks:{d:{mask:b.MaskedRange,placeholderChar:"_",from:1,to:31,maxLength:2},m:{mask:b.MaskedRange,placeholderChar:"_",from:1,to:12,maxLength:2},Y:{mask:b.MaskedRange,placeholderChar:"_",from:1900,to:2999,maxLength:4}},onAccept:p=>c(p),onBlur:l,placeholder:"__.__.___","aria-placeholder":"Eingabeformat Tag Monat Jahr zum Beispiel 12.05.2022","aria-invalid":!!d,"aria-describedby":d?`${s}-error`:void 0,required:o})]}),!!d&&e.jsx(B,{id:`${s}-error`,error:!0,children:d.message})]})}const de=t=>{const[r,s,a]=t.split("."),o=w.fromISO(`${a}-${s}-${r}`).startOf("month").toMillis(),i=32,c=w.now().minus({month:i}).startOf("month").toMillis();return o>=c?!0:`Elterngeld wird maximal für ${i} Lebensmonate rückwirkend gezahlt.`};function he({initialValues:t,onSubmit:r,handleDirtyForm:s}){const{register:a,handleSubmit:o,setValue:i,control:c,watch:l,formState:u,getValues:g}=se({defaultValues:t}),{fields:d,append:p,remove:F}=te({name:"geschwisterkinder",control:c}),z=$(),A=()=>z("/allgemeine-angaben"),{isDirty:x,dirtyFields:k}=u;a("anzahlKuenftigerKinder",{valueAsNumber:!0});const _=l("anzahlKuenftigerKinder"),C=l("wahrscheinlichesGeburtsDatum");le(J(C));const E=()=>i("anzahlKuenftigerKinder",Math.max(_-1,0),{shouldDirty:!0}),I=()=>i("anzahlKuenftigerKinder",Math.min(_+1,8),{shouldDirty:!0}),T=()=>p({geburtsdatum:"",istBehindert:!1});S.useEffect(()=>{s(x,k)},[x,k,s]);const j="wahrscheinlichesGeburtsDatum",R=g(j),D=m=>{const[h,f,L]=m.split(".");return w.fromISO(`${L}-${f}-${h}`)},V=m=>{if(m==="")return!0;const h=D(m),f=D(R);return h<f?!0:"Das Geschwisterkind muss älter als das Kind oben sein."};return e.jsxs("form",{onSubmit:o(r),name:"Ihr Nachwuchs",noValidate:!0,children:[e.jsxs(G,{headline:"Kinder",children:[e.jsx(M,{control:c,rules:{required:"Dieses Feld ist erforderlich",pattern:{value:/^\d{2}\.\d{2}\.\d{4}$/,message:"Bitte das Feld vollständig ausfüllen oder leer lassen"},validate:{validateMonth:de}},name:j,label:"Wann wird Ihr Kind voraussichtlich geboren?",required:!0,info:re.kindGeburtsdatum}),e.jsx(ue,{register:a,registerOptions:{max:{value:8,message:"Es können nicht mehr als 8 Kinder angegeben werden"},min:{value:1,message:"Es muss mindestens ein Kind angegeben werden"},required:"Dieses Feld ist erforderlich"},name:"anzahlKuenftigerKinder",label:"Wie viele Kinder erwarten Sie (z.B. Zwillinge)?",errors:u.errors,onIncrease:I,onDecrease:E,required:!0})]}),e.jsxs(G,{headline:"Ältere Geschwisterkinder (falls vorhanden)",description:`Wenn es kein Geschwisterkind gibt, können Sie diesen Schritt einfach
          überspringen.`,children:[e.jsx("ul",{className:n("nachwuchs-form__geschwisterkinder"),children:d.map((m,h)=>e.jsxs("li",{role:"region","aria-label":`${h+1}. Geschwisterkind`,children:[h>0&&e.jsx("h3",{className:"mb-10",children:"Geschwisterkind"}),e.jsx(M,{control:c,rules:{pattern:{value:/^\d{2}\.\d{2}\.\d{4}$/,message:"Bitte das Feld vollständig ausfüllen oder leer lassen"},validate:V},name:`geschwisterkinder.${h}.geburtsdatum`,label:"Wann wurde das Geschwisterkind geboren?"}),e.jsx(ne,{register:a,name:`geschwisterkinder.${h}.istBehindert`,label:"Das Geschwisterkind hat eine Behinderung"}),e.jsx(v,{onClick:()=>F(h),iconAfter:e.jsx(ae,{}),className:n("nachwuchs-form__geschwisterkinder-delete"),buttonStyle:"link",label:"Geschwisterkind entfernen"})]},m.id))}),e.jsx(v,{onClick:T,iconBefore:e.jsx(K,{}),ariaLabel:`${d.length?"Weiteres":"Älteres"} Geschwisterkind hinzufügen`,buttonStyle:"secondary",label:`${d.length?"Weiteres":"Älteres"} Geschwisterkind hinzufügen`})]}),e.jsx(ie,{onClickBackButton:A})]})}function be(){const t=P(),r=$(),s=q(l=>l.stepNachwuchs),[a,o]=S.useState(!1),i=l=>{a&&t(H.setHasBEGResultChangedDueToPrevFormSteps({ET1:!0,ET2:!0})),t(Z.submitStep(l)),r(N.erwerbstaetigkeit.route)},c=l=>{o(l)};return e.jsx(Y,{step:N.nachwuchs,children:e.jsx(he,{initialValues:s,onSubmit:i,handleDirtyForm:c})})}export{be as default};
