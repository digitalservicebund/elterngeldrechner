import{j as e,Y as S,n as o,u as C,r as f,s as L,B as v,o as G,b as h,q as X,k as M,t as J,E as P,P as Q,f as ee}from"./index-CVEjQdf8.js";import{j as ne,u as te,d as se,g as re,F as ie,D as oe,e as ae,k as le,Z as me,_ as ce,l as ue,R as A,T as $,M as de}from"./Monatsplaner-DmwpB1xT.js";import{E as he}from"./egr-configuration-BkWsa5ZA.js";function be({elternteilName:a,alleinerziehend:n}){return e.jsx("div",{children:n!==S.YES?`Das Ergebnis der Berechnung für ${a} hat sich verändert, da Sie Angaben im Formular geändert haben.`:"Das Ergebnis der Berechnung hat sich verändert, da Sie Angaben im Formular geändert haben."})}function ge(){return e.jsx("div",{children:"Von Ihrem Netto Einkommen werden höchstens 2770 Euro für die Festlegung des Elterngelds berücksichtigt. In den Lebensmonaten, in denen Sie kein Einkommen haben, bekommen Sie den Elterngeld-Höchstbetrag von 1800 Euro (ohne Geschwisterbonus). In den Lebensmonaten, in denen Sie Einkommen haben, wird Ihr Elterngeld berechnet aus dem Unterschied zwischen 2770 Euro und Ihrem Einkommen nach der Geburt."})}function K({id:a,number:n,prefix:r,children:c}){return e.jsxs("div",{id:a,className:o("foot-note"),children:[!!n&&e.jsx(ne,{type:"note",number:n,prefix:r,className:o("foot-note__number")}),e.jsx("div",{className:o("foot-note__note"),children:c})]})}function D({elternteilName:a,elternteil:n,initialValues:r,onSubmit:c,isResultPending:b,previousFormStepsChanged:g}){const{control:E,handleSubmit:p,getValues:l,setValue:i,register:N,formState:{errors:j}}=te({defaultValues:r}),x=C(),u=`${n}.bruttoEinkommenZeitraum`,s=`${n}.keinEinkommen`,{fields:B,append:Z,remove:O}=se({name:u,control:E}),k=()=>{const m=[];for(let t=0;t<he.lebensMonateMaxNumber;t++){const d=`${t+1}`;m.push({label:d,value:d})}return m},[U,R]=f.useState(()=>!1),[T,_]=f.useState(new Array(B.length).fill({from:k(),to:k()})),I=m=>ue(T.map((t,d)=>l(`${u}.${d}.zeitraum`)).map(t=>({from:t.from,to:t.to})),{from:k(),to:k()},"Integer",m),V=m=>{m?i(u,[]):l(u).length<1&&(i(u,[G]),_(()=>[{from:k(),to:k()}]))},Y=()=>{const m=I();_(d=>[...d,m]),Z(G),i(s,!1);const t=m.from.filter(d=>!d.hidden).length;R(t===1)},H=m=>{_(t=>t.filter((d,w)=>w!==m)),O(m),l(u).length<1&&i(s,!0),R(!1)},q=(m,t)=>{const d=I(t).from.filter(w=>!w.hidden);R(d.length===0)},W=f.useMemo(()=>({validate:{requireKeinEinkommenOrEinkommen:m=>{const t=l(u);return m||t.length>0?!0:'Bitte geben Sie ihr Einkommen während des Elterngeldbezugs an oder wählen sie "kein Einkommen beziehen"'}}}),[l,u]),z=re(j,s);return f.useEffect(()=>{g&&x(L.resetHasBEGResultChangedDueToPrevFormSteps({elternteil:n}))},[g,x,n]),e.jsx("form",{onSubmit:p(c),className:o("rechner-form"),noValidate:!0,children:e.jsxs(ie,{headline:a,"data-testid":"egr-rechner-form",children:[!!z&&e.jsx(oe,{id:`${s}-error`,error:!0,children:z.message}),e.jsx(ae,{register:N,name:s,label:"Ich werde während des gesamten Elterngeldbezugs kein Einkommen beziehen",onChange:V,registerOptions:W,"aria-invalid":!!z}),e.jsx("p",{children:"oder"}),B.map((m,t)=>e.jsxs("section",{"aria-label":`${t+1}. Einkommen`,className:o("rechner-form__zeitraum-section"),children:[e.jsx(le,{className:o("rechner-form__einkommen"),control:E,name:`${u}.${t}.bruttoEinkommen`,label:"Ihr monatliches Bruttoeinkommen oder durchschnittlicher monatlicher Gewinn während des Bezugs von Elterngeld",suffix:"Euro",stretch:!0,required:!0,ariaDescribedByIfNoError:`${u}.${t}.zeitraum`}),e.jsx(me,{disabled:t+1!==B.length,className:o("rechner-form__zeitraum"),register:N,setValue:i,getValues:l,name:`${u}.${t}.zeitraum`,suffix:"Lebensmonat",options:T[t].from,optionsTo:T[t].to,onChange:d=>q(t,d),type:"Integer",errors:j,required:!0},m.id),e.jsx("div",{className:o("rechner-form__remove-action"),children:e.jsx(v,{buttonStyle:"link",label:"Einkommen entfernen",iconAfter:e.jsx(ce,{}),onClick:()=>{H(t)}})})]},m.id)),e.jsxs("div",{className:o("rechner-form__actions"),children:[e.jsx("div",{className:o("rechner-form__add-action"),children:e.jsx(v,{buttonStyle:"secondary",onClick:()=>Y(),label:"Einkommen hinzufügen",disabled:U})}),e.jsx(v,{buttonStyle:"primary",disabled:b,label:"Elterngeld berechnen",isSubmitButton:!0})]})]})})}const F=(a,n)=>n.filter(r=>r.elternGeldPlus!==0||r.basisElternGeld!==0).map(r=>{const c=a(r);return{vonLebensMonat:r.vonLebensMonat,bisLebensMonat:r.bisLebensMonat,amountElterngeld:c,amountTotal:c+r.nettoEinkommen}});function y({elternteil:a}){const n=h(i=>i.stepRechner[a].elterngeldResult),[r,c]=f.useState(null);if(f.useEffect(()=>{n.state==="success"?n.data.every(i=>i.basisElternGeld>=1800||i.nettoEinkommen>=2770?(c([e.jsx(ge,{},i.vonLebensMonat)]),!1):!0):c(null)},[n]),n.state==="init"||n.state==="pending")return null;if(n.state==="error")return e.jsxs("p",{className:o("rechner-result-error"),children:[e.jsx(X,{})," Das Elterngeld konnte nicht berechnet werden."]});const b=F(i=>i.basisElternGeld,n.data),g=F(i=>i.elternGeldPlus,n.data),E=F(i=>i.elternGeldPlus,n.data),p=b.some(i=>i.vonLebensMonat>14||i.bisLebensMonat>14),l=()=>{c(null)};return e.jsxs("section",{className:o("rechner-result"),"aria-label":"Elterngeld berechnen Ergebnis",children:[e.jsx(A,{className:o("rechner-result__basiselterngeld"),rows:b,elterngeldType:"Basis",elternteil:a,titleTotal:"Basis + Netto-Einkommen",markOver14Month:p}),!!p&&e.jsx(K,{number:1,prefix:"rechner",children:"*Basiselterngeld können Sie nur bis zum 14. Lebensmonat beantragen"}),e.jsx(A,{className:o("rechner-result__elterngeldplus"),rows:g,elterngeldType:"Plus",elternteil:a,titleTotal:"Plus + Netto-Einkommen",hideLebensmonate:!0}),e.jsx(A,{className:o("rechner-result__elterngeldbonus"),rows:E,elterngeldType:"Bonus",elternteil:a,titleTotal:"Bonus + Netto-Einkommen",hideLebensmonate:!0}),!!r&&e.jsx($,{messages:r,active:!!r,onUnMount:l,timeout:12e3})]})}function Ee(){const a=C(),n=h(s=>s.stepRechner),[r,c]=f.useState(null),b=h(s=>s.stepRechner.ET1.hasBEGResultChangedDueToPrevFormSteps),g=h(s=>s.stepRechner.ET2.hasBEGResultChangedDueToPrevFormSteps),E=h(M.getElternteilNames),p=h(M.getAntragssteller),l=h(M.getAlleinerziehend),i=h(s=>s.stepRechner.ET1.elterngeldResult.state),N=h(s=>s.stepRechner.ET2.elterngeldResult.state),j=({ET1:s})=>{a(L.calculateBEG({elternteil:"ET1",bruttoEinkommenZeitraum:s.bruttoEinkommenZeitraum}))},x=({ET2:s})=>{a(L.calculateBEG({elternteil:"ET2",bruttoEinkommenZeitraum:s.bruttoEinkommenZeitraum}))};f.useEffect(()=>{b&&j(n),g&&x(n)},[]),f.useEffect(()=>{const s=[];b&&s.push(E.ET1),g&&s.push(E.ET2),s.length>0&&c([e.jsx(be,{elternteilName:s.join(" und "),alleinerziehend:l},"beg-result-was-recalculated")])},[b,g,E,l]);const u=()=>{c(null)};return e.jsxs("section",{className:o("rechner"),children:[e.jsx(K,{prefix:"rechner",children:"Elterngeld wird monatsweise gezahlt – allerdings nicht nach Kalendermonaten, sondern nach den Lebensmonaten Ihres Kindes. Diese beginnen nicht am Ersten des Kalendermonats, sondern je nach Geburtstag Ihres Kindes. Wenn Ihr Kind am 14. Februar geboren ist, dann ist der 1. Lebensmonat vom 14. Februar bis zum 13. März, der 2. Lebensmonat vom 14. März bis zum 13. April und so weiter."}),e.jsxs("section",{className:o("rechner__description"),children:[e.jsx("p",{className:"font-bold",children:"Hier können Sie beispielhaft berechnen, wie viel Elterngeld Sie in welcher Phase Ihrer Elternzeit erwarten können. Bitte beachten Sie, dass das hier berechnete Ergebnis nur eine Orientierung für Sie sein kann. Das Ergebnis ist daher nicht bindend."}),e.jsx("p",{children:"Die Höhe des Elterngelds hängt von 3 Faktoren ab:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"der Höhe Ihres monatlichen Bruttoeinkommens vor der Geburt,"}),e.jsx("li",{children:"der von Ihnen gewählten Variante des Elterngelds"}),e.jsx("li",{children:"und der Höhe des monatlichen Bruttoeinkommens während des Bezugs von Elterngeld"})]}),e.jsx("p",{children:"Im Folgenden können Sie unter Berücksichtigung dieser Faktoren berechnen und probieren, was am besten zu Ihren Vorstellungen für die Zeit nach der Geburt passt."})]}),e.jsx(D,{elternteilName:l===S.YES?"Elterngeld-Anspruch":E.ET1,elternteil:"ET1",initialValues:n,isResultPending:i==="pending",onSubmit:j,previousFormStepsChanged:b}),e.jsx("div",{"data-testid":"rechner-result-et1",children:e.jsx(y,{elternteil:"ET1"})}),p==="FuerBeide"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{elternteilName:l===S.YES?"Elterngeld-Anspruch":E.ET2,elternteil:"ET2",initialValues:n,isResultPending:N==="pending",onSubmit:x,previousFormStepsChanged:g}),e.jsx("div",{"data-testid":"rechner-result-et2",children:e.jsx(y,{elternteil:"ET2"})})]}),e.jsx($,{messages:r,active:!!r,onUnMount:u,timeout:1e4})]})}function fe({text:a,buttonLabel:n,onClick:r}){return e.jsx("div",{className:o("modal-popup"),children:e.jsxs("div",{className:o("modal-popup__info"),children:[e.jsx("p",{children:a}),e.jsx(v,{className:o("modal-popup__btn"),onClick:r,label:n,buttonStyle:"primary"})]})})}function xe(){const a=h(l=>l.stepNachwuchs),n=h(l=>l.stepAllgemeineAngaben),r=h(l=>l.stepEinkommen.limitEinkommenUeberschritten===S.YES?!0:null),c=J(a.anzahlKuenftigerKinder,n.mutterschaftssleistungen),[b,g]=f.useState(r),p=h(M.getAlleinerziehend)===S.YES?P.MAX_EINKOMMEN_ALLEIN:P.MAX_EINKOMMEN_BEIDE;return e.jsxs(Q,{step:ee.rechnerUndPlaner,children:[e.jsx("h3",{className:"mb-10",children:"Rechner und Planer"}),e.jsx(Ee,{}),e.jsx(de,{mutterSchutzMonate:c}),!!b&&e.jsx(fe,{text:`Wenn Sie besonders viel Einkommen haben, können Sie kein Elterngeld bekommen. Falls noch nicht feststeht, ob Sie die Grenze von ${p.toLocaleString()} Euro überschreiten, können Sie trotzdem einen Antrag stellen.`,buttonLabel:"Dialog schließen",onClick:()=>{g(!1)}})]})}export{xe as default};
